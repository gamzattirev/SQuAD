{"description": "Enterprise techniques used by menuPass, ATT&CK group G0045 v1.2", "name": "menuPass (G0045)", "domain": "mitre-enterprise", "version": "2.1", "techniques": [{"score": 1, "techniqueID": "T1087", "comment": "menuPass has used the Microsoft administration tool csvde.exe to export Active Directory data."}, {"score": 1, "techniqueID": "T1059", "comment": "menuPass executes commands using a command-line interface and reverse shell. The group has used a modified version of pentesting script wmiexec.vbs to execute commands."}, {"score": 1, "techniqueID": "T1090", "comment": "menuPass has used a global service provider's IP as a proxy for C2 traffic from a victim."}, {"score": 1, "techniqueID": "T1003", "comment": "menuPass has used a modified version of pentesting tools wmiexec.vbs and secretsdump.py to dump credentials."}, {"score": 1, "techniqueID": "T1002", "comment": "menuPass has compressed files before exfiltration using TAR and RAR."}, {"score": 1, "techniqueID": "T1022", "comment": "menuPass has encrypted files and information before exfiltration."}, {"score": 1, "techniqueID": "T1005", "comment": "menuPass has collected various files from the compromised computers."}, {"score": 1, "techniqueID": "T1039", "comment": "menuPass has collected data from remote systems by mounting network shares with net use and using Robocopy to transfer data."}, {"score": 1, "techniqueID": "T1074", "comment": "menuPass stages data prior to exfiltration in multi-part archives, often saved in the Recycle Bin."}, {"score": 1, "techniqueID": "T1140", "comment": "menuPass has used certutil in a macro to decode base64-encoded content contained in a dropper document attached to an email. The group has also used certutil -decode to decode files on the victim\u2019s machine when dropping UPPERCUT."}, {"score": 1, "techniqueID": "T1038", "comment": "menuPass has used DLL search order hijacking."}, {"score": 1, "techniqueID": "T1073", "comment": "menuPass has used DLL side-loading to launch versions of Mimikatz and PwDump6 as well as UPPERCUT."}, {"score": 1, "techniqueID": "T1107", "comment": "A menuPass macro deletes files after it has decoded and decompressed them."}, {"score": 1, "techniqueID": "T1056", "comment": "menuPass has used key loggers to steal usernames and passwords."}, {"score": 1, "techniqueID": "T1036", "comment": "menuPass has been seen changing malicious files to appear legitimate. They have also renamed certutil and move it to a different location on system to avoid detection based on use of the tool."}, {"score": 1, "techniqueID": "T1046", "comment": "menuPass has used tcping.exe, similar to Ping, to probe port status on systems of interest."}, {"score": 1, "techniqueID": "T1027", "comment": "menuPass has encoded strings in its malware with base64 as well as with a simple, single-byte XOR obfuscation using key 0x40."}, {"score": 1, "techniqueID": "T1086", "comment": "menuPass uses PowerSploit to inject shellcode into PowerShell."}, {"score": 1, "techniqueID": "T1093", "comment": "menuPass has used process hollowing in iexplore.exe to load the RedLeaves implant."}, {"score": 1, "techniqueID": "T1076", "comment": "menuPass has used RDP connections to move across the victim network."}, {"score": 1, "techniqueID": "T1105", "comment": "menuPass has installed updates and new malware on victims."}, {"score": 1, "techniqueID": "T1021", "comment": "menuPass has used Putty Secure Copy Client (PSCP) to transfer data."}, {"score": 1, "techniqueID": "T1018", "comment": "menuPass uses scripts to enumerate IP ranges on the victim network. menuPass has also issued the command net view /domain to a PlugX implant to gather information about remote systems on the network."}, {"score": 1, "techniqueID": "T1053", "comment": "menuPass has used a script (atexec.py) to execute a command on a target machine via Task Scheduler."}, {"score": 1, "techniqueID": "T1064", "comment": "menuPass has used malicious macros embedded inside Office documents to execute files."}, {"score": 1, "techniqueID": "T1193", "comment": "menuPass has sent malicious Office documents via email as part of spearphishing campaigns as well as executables disguised as documents."}, {"score": 1, "techniqueID": "T1016", "comment": "menuPass has used several tools to scan for open NetBIOS nameservers and enumerate NetBIOS sessions."}, {"score": 1, "techniqueID": "T1049", "comment": "menuPass has used net use to conduct connectivity checks to machines."}, {"score": 1, "techniqueID": "T1199", "comment": "menuPass has used legitimate access granted to Managed Service Providers in order to access victims of interest."}, {"score": 1, "techniqueID": "T1204", "comment": "menuPass has attempted to get victims to open malicious files such as Windows Shortcuts (.lnk) and/or Microsoft Office documents, sent via email as part of spearphishing campaigns."}, {"score": 1, "techniqueID": "T1078", "comment": "menuPass has used valid accounts shared between Managed Service Providers and clients to move between the two environments."}, {"score": 1, "techniqueID": "T1047", "comment": "menuPass uses a modified version of pentesting script wmiexec.vbs, which logs into a remote machine using WMI."}], "gradient": {"colors": ["#ffffff", "#66b1ff"], "minValue": 0, "maxValue": 1}, "legendItems": [{"label": "used by menuPass", "color": "#66b1ff"}]}